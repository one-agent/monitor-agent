## 智能客服监控 Agent

## 背景与价值

### 场景故事

阿强是某 AI 平台的运维兼客服负责人。通过知识库，他维护了一套自动回复系统，但每当底层模型 API 出现波动或宕机时，用户依然会收到"千篇一律"的回答，而不知道系统真实的健康状况。

阿强希望构建一个"具备感知能力"的智能客服。它不仅能基于文档回答业务问题，还能实时连接 Uptime Kuma 监控系统。当 API 报错时，它能自动通过 Webhook 通知飞书运维群，并在 Apifox 中记录故障文档；当用户询问"今天系统稳定吗"时，它能基于监控历史给出真实的回答，而不是瞎编。

### 为什么选这个场景

- 业务刚需：将 RAG（检索增强生成）与 DevOps（运维监控）结合，解决客服"不知系统死活"的痛点。
- 全栈考察：既考察文档理解能力，又考察 Agent 调用外部工具（API、Webhook）的执行能力。
- 数据联动：体现了从"监控发现"到"告警通知"再到"文档沉淀"的完整自动化数据闭环。

### 考察点

---

## 任务定义

### 输入：

- 用户提问（关于平台功能或系统稳定性）。
- 系统事件流（模拟 API 的状态变化，如 200 OK 或 500 Error）。

### 输出：

- 智能回复：针对用户提问的自然语言回答。
- 系统动作：触发的飞书 Webhook 请求、生成的 Apifox 文档记录。

### 输入格式

输入文件 inputs.json：

```json
[
    {
        "case_id": "C001",
        "user_query": "你们平台的计费模式是怎样的？",
        "api_status": "200 OK",
        "api_response_time": "120ms",
        "monitor_log": []
    },
    {
        "case_id": "C002",
        "user_query": "刚才模型是不是挂了？怎么一直没反应？",
        "api_status": "500 Internal Server Error",
        "api_response_time": "Timeout",
        "monitor_log": [
            {
                "timestamp": "10:00:01",
                "status": "Error",
                "msg": "Connection Refused"
            }
        ]
    }
]
```



### 输出格式

选手需提交代码运行后的结果文件 outputs/results.json，以及执行过程中产生的动作日志。

### results.json 示例：

```json
[
    {
        "case_id": "C001",
        "reply": "根据平台文档，我们提供按量付费和包月订阅两种模式。按量付费的价格为...",
        "action_triggered": null
    },
    {
        "case_id": "C002",
        "reply": "非常抱歉，检测到模型 API 在 10:00:01 出现了短暂的连接异常。目前系统正在自动修复中，请您稍后再试。",
        "action_triggered": {
            "feishu_webhook": "Sent success",
            "apifox_doc_id": "DOC_20241212_ERROR_01"
        }
    }
]
```



### 动作规范要求：

#### 状态监控：

必须基于 Uptime Kuma (或其模拟逻辑) 监听目标 API。
当 api_status != 200 时，触发报警流程。

#### 飞书告警：

通过 Webhook 向指定飞书账号/群发送富文本卡片。
内容需包含：报错时间、错误代码、当前延迟。

#### Apifox 文档同步：

调用 Apifox 开放 API，自动生成一篇新的接口文档或错误日志。
文档标题格式：[故障记录] YYYY-MM-DD HH:mm:ss。

### 内容规范

- 智能问答：必须基于提供的"胜算云知识库"回答，严禁产生幻觉。如果知识库中没有答案，需回答"知识库中未找到相关信息"。
- 稳定性回答：当被问及稳定性时，严禁直接回答"很稳定"，必须读取监控日志（monitor_log），如果有报错记录，需诚实告知用户最近的异常情况。



### 评分标准（100分）

| 维度 | 分值 | 说明 |
| --- | --- | --- |
| 问答准确性 | 30 | 能够准确根据知识库回答业务问题，无幻觉。 |
| 监控灵敏度 | 30 | 能准确识别 API 异常状态，不漏报、不误报。 |
| 工具链集成 | 30 | 飞书 Webhook 消息格式正确；Apifox 文档成功生成且内容详实。 |
| 自我感知 | 10 | 在回答用户关于"稳定性"提问时，能正确引用监控数据。 |

### 难度梯度

| 等级 | 目标分 | 达成条件 |
| --- | --- | --- |
| 入门 | 60分 | 完成基础问答，能检测到报错并打印日志（未连接真实工具）。 |
| 进阶 | 80分 | 完成飞书 Webhook 告警，问答准确率高。 |
| 挑战 | 95分+ | 完整实现 Apifox 同步，且 Agent 能在对话中完美解释系统当前的技术状态。 |
